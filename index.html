<!DOCTYPE html>
<html>

<head>
    <!-- A-Frame -->
    <script src="https://aframe.io/releases/1.6.0/aframe.min.js"></script>
    <!-- we use three.js to handle raycasting -->
    <script src="https://raw.githack.com/AR-js-org/AR.js/master/three.js/build/ar-threex.js"></script>
    <!-- AR.js A-Frame components -->
    <script src="https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar.js"></script>
    
    <script>
        // Component for playing sound on click
        AFRAME.registerComponent('clicker', {
            init: function () {
                this.soundEl = document.querySelector('#click-sound');
                this.el.addEventListener('click', () => {
                    this.soundEl.components.sound.playSound();
                });
            }
        });

        // Component for handling marker found/lost events
        AFRAME.registerComponent('markerhandler', {
            init: function () {
                let marker = this.el;
                let model = document.querySelector('#car-model');

                marker.addEventListener('markerFound', () => {
                    let position = marker.object3D.position.clone(); // Store position
                    let rotation = marker.object3D.rotation.clone(); // Store rotation

                    model.setAttribute('position', `${position.x} ${position.y} ${position.z}`);
                    model.setAttribute('rotation', `${rotation.x} ${rotation.y} ${rotation.z}`);
                    model.setAttribute('visible', true);
                });

                marker.addEventListener('markerLost', () => {
                    // Keep the model in place when the marker is lost
                    model.removeAttribute('animation__follow');
                    model.setAttribute('visible', true);
                });
            }
        });
    </script>
</head>

<body style="margin: 0; overflow: hidden;">

    <a-scene embedded arjs vr-mode-ui="enabled: false"
        arjs="sourceType: webcam; videoTexture: true; debugUIEnabled: false"
        cursor="rayOrigin: mouse" raycaster="objects: .clickable">

        <!-- Marker -->
        <a-marker markerhandler>
            <a-entity id="car-model"
                gltf-model="https://ses011.github.io/MallMixAR.github.io/porsche/scene.gltf"
                scale="1 1 1" rotation="-90 0 0" position="0 -8 0" clicker>
            </a-entity>
        </a-marker>

        <!-- Sound -->
        <a-entity id="click-sound"
            sound="src: https://ses011.github.io/MallMixAR.github.io/car-horn.mp3; autoplay: false"></a-entity>

        <a-camera><a-cursor></a-cursor></a-camera>

    </a-scene>

</body>

</html>


<!-- <!DOCTYPE html>
<html>

<head>
    <script src="https://aframe.io/releases/1.6.0/aframe.min.js"></script>
    <script src="https://raw.githack.com/AR-js-org/AR.js/master/three.js/build/ar-threex.js"></script>
    <script src="https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar.js"></script>
    <script>
        AFRAME.registerComponent('markerhandler', {
            init: function () {
                let marker = this.el;
                let model = document.querySelector('#car-model');

                marker.addEventListener('markerFound', () => {
                    let position = marker.getAttribute('position');
                    model.setAttribute('position', position);
                    model.setAttribute('visible', true);
                });

                marker.addEventListener('markerLost', () => {
                    model.setAttribute('visible', true); 
                });
            }
        });
    </script>
</head>

<body style='margin: 0; overflow: hidden;'>

    <a-scene embedded arjs vr-mode-ui='enabled: false'
        arjs='sourceType: webcam; videoTexture: true; debugUIEnabled: false' renderer='antialias: true; alpha: true'
        cursor='rayOrigin: mouse' raycaster="objects: .clickable">

       
        <a-marker markerhandler>
        </a-marker>
        <a-entity id="car-model" gltf-model="https://ses011.github.io/MallMixAR.github.io/porsche/scene.gltf"
            scale="1 1 1" rotation="-90 0 0" position="0 -8 0" visible="false" clicker></a-entity>

   
        <a-entity id="click-sound"
            sound="src: https://ses011.github.io/MallMixAR.github.io/car-horn.mp3; autoplay: false"></a-entity>

        <a-camera><a-cursor></a-cursor></a-camera>

    </a-scene>

</body>

</html> -->
